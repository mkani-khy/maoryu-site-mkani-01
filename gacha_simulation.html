<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>まおりゅう ガチャシミュレーション</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <style>
        /* --- CSSスタイル (前回と同一) --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #1a1a2e; color: #e0e0e0; }
        h1 { text-align: center; color: #ffc107; border-bottom: 3px solid #00bcd4; padding-bottom: 10px; margin-bottom: 30px; text-shadow: 1px 1px 3px #000; }
        h3 { color: #00bcd4; border-left: 5px solid #ffc107; padding-left: 10px; margin-top: 25px; margin-bottom: 15px; }
        
        .gacha-panel {
            background-color: #2c394b; 
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            margin-bottom: 20px;
            border: 1px solid #00bcd4;
        }

        #probabilitySettings { display: flex; gap: 30px; justify-content: center; margin-bottom: 20px; }
        .prob-item { text-align: center; }
        .prob-item label { display: block; margin-bottom: 5px; color: #00bcd4; font-weight: bold; }
        .prob-item input { width: 80px; text-align: right; padding: 8px; border-radius: 4px; border: 1px solid #555; background-color: #3e4a59; color: #e0e0e0; }
        #prob_info { text-align: center; font-size: 0.9em; color: #ffc107; margin-bottom: 15px; }

        button { cursor: pointer; padding: 10px 20px; border-radius: 5px; border: none; font-weight: bold; transition: background-color 0.3s; }
        #gachaButton { font-size: 1.2em; padding: 15px 30px; background-color: #dc3545; color: white; margin-right: 15px; }
        #gachaButton:hover { background-color: #c82333; }
        #resetButton { background-color: #5a6268; color: white; padding: 15px 30px; }
        #resetButton:hover { background-color: #4e555b; }

        #summaryArea { text-align: center; padding: 15px; border: 1px solid #ffc107; border-radius: 5px; background-color: #3e4a59; }
        #summaryArea p { font-size: 1.2em; margin: 5px 0; }
        #summaryArea span { color: #ffc107; font-weight: bold; font-size: 1.5em; margin-left: 10px; }

        .pulled-chara {
            width: 90px; text-align: center; position: relative; animation: fadeIn 0.5s ease-out; font-size: 0.8em; flex-shrink: 0;
        }
        .pulled-chara img {
            width: 80px; height: 80px; border-radius: 50%; border: 3px solid #00bcd4; object-fit: cover; box-shadow: 0 0 8px rgba(255, 255, 0, 0.5);
        }
        .rarity-tag {
            position: absolute; top: 0; right: 0; background-color: #dc3545; color: white; padding: 2px 5px; border-radius: 0 5px 0 5px; font-size: 0.7em; font-weight: bold; z-index: 10;
        }
        .extreme { border-color: gold !important; }
        .pickup { border-color: #ff00ff !important; }

        #gachaResultDisplay, #cumulativeResultDisplay {
            display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; padding: 20px 0; min-height: 100px;
        }

        #cumulativeResultDisplay {
            max-height: 400px; /* 好きな高さに固定 */
            overflow-y: auto;  /* 中身が増えたらスクロール */
            border: 1px inset #3e4a59;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.2);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 600px) {
            /* 確率設定を2列ずつ並べてスッキリさせる */
            #probabilitySettings {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            /* ボタンを縦に並べて押しやすくする */
            #gachaButton, #resetButton {
                display: block;
                width: 100%;
                margin: 10px 0;
                font-size: 1.1em;
            }

            /* 当たったキャラのアイコンを少し小さくして横並びの崩れを防ぐ */
            .pulled-chara {
                width: 75px;
            }
            .pulled-chara img {
                width: 65px;
                height: 65px;
            }
        }
    </style>
</head>
<body>
    <h1>ガチャシミュレーション</h1>

    <p style="text-align: center;">
        <a href="index.html" style="font-size: 1.1em; color: #007bff;">
            ← まとめサイトTOPへ戻る
        </a>
    </p>

    <div class="gacha-panel">
        <h3>確率設定 (%)</h3>
        <p id="prob_info">※10連の確定枠を廃止し、すべて通常抽選になりました。</p>
        
        <div id="probabilitySettings">
            <div class="prob-item">
                <label for="prob5Total">★5 全体</label>
                <input type="text" id="prob5Total" value="6.000" disabled>
            </div>
            <div class="prob-item">
                <label for="prob4">★4 確率</label>
                <input type="text" id="prob4" value="30.000" disabled>
            </div>
            <div class="prob-item">
                <label for="prob3">★3 確率</label>
                <input type="text" id="prob3" value="64.000" disabled>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button id="gachaButton" onclick="simulateGacha()">10連スカウトを行う</button>
            <button id="resetButton" onclick="resetHistory()">履歴をリセット</button>
        </div>
    </div>

    <div id="resultContainer" class="gacha-panel" style="display: none;">
        <h3>今回のスカウト結果</h3>
        <div id="summaryArea">
            <p>★5 キャラクター: <span id="count5">0</span> 体</p>
            <p>★4 キャラクター: <span id="count4">0</span> 体</p>
            <p>★3 キャラクター: <span id="count3">0</span> 体</p>
        </div>
        
        <h4 style="color: #ffc107; text-align: center; margin-top: 20px;">当選キャラクター (★5以上/極みのみ表示)</h4>
        <div id="gachaResultDisplay">
        </div>
    </div>

    <div class="gacha-panel">
        <h3>累計統計</h3>
        <div id="cumulativeSummary" style="text-align: center;">
            <p>総スカウト回数: <span id="totalPulls">0</span> 回</p>
            <p>累計 ★5 (極み含む): <span id="totalCount5">0</span> 体 (<span id="totalRate5">0.000</span>%)</p>
            <p>累計 ★4: <span id="totalCount4">0</span> 体 (<span id="totalRate4">0.000</span>%)</p>
            <p>累計 ★3: <span id="totalCount3">0</span> 体 (<span id="totalRate3">0.000</span>%)</p>
        </div>

        <h4 style="color: #ffc107; text-align: center; margin-top: 30px;">累計当選キャラクター (★5以上/極み)</h4>
        <div id="cumulativeResultDisplay">
        </div>
    </div>
    <p style="text-align: center;">
        <a href="index.html" style="font-size: 1.1em; color: #007bff;">
            ← まとめサイトTOPへ戻る
        </a>
    </p>

    <script src="script_gacha.js"></script>
</body>
</html>